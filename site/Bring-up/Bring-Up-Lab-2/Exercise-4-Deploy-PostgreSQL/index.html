
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.18">
    
    
      
        <title>Exercise 4: Deploy PostgreSQL - BADL - Labs</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.66ac8b77.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:300,300i,400,400i,700,700i%7CIBM+Plex+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"IBM Plex Sans";--md-code-font:"IBM Plex Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#exercise-4-deploy-postgresql" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="BADL - Labs" class="md-header__button md-logo" aria-label="BADL - Labs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            BADL - Labs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Exercise 4: Deploy PostgreSQL
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../Readme/" class="md-tabs__link">
        
  
    
  
  Bring-up

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../Business%20Automation%20Application/" class="md-tabs__link">
        
  
    
  
  Business Automation Application

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../Business%20Automation%20Insights/" class="md-tabs__link">
        
  
    
  
  Business Automation Insights

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../Content/Readme/" class="md-tabs__link">
        
  
    
  
  Content

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../Decisions/README.md" class="md-tabs__link">
        
  
    
  
  Decisions

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../Document%20Processing/Readme/" class="md-tabs__link">
        
  
    
  
  Document Processing

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../IBM%20Cloud%20Pak%20for%20Business%20Automation%20%28End-to-End%29/" class="md-tabs__link">
        
  
    
  
  IBM Cloud Pak for Business Automation (End-to-End)

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../Process%20Mining/" class="md-tabs__link">
        
  
    
  
  Process Mining

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../Robotic%20Process%20Automation/" class="md-tabs__link">
        
  
    
  
  Robotic Process Automation

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../watsonx%20Orchestrate/" class="md-tabs__link">
        
  
    
  
  Watsonx Orchestrate

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../Workflow/" class="md-tabs__link">
        
  
    
  
  Workflow

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="BADL - Labs" class="md-nav__button md-logo" aria-label="BADL - Labs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    BADL - Labs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bring-up
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Business%20Automation%20Application/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Business Automation Application
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Business%20Automation%20Insights/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Business Automation Insights
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Content/Readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Content
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Decisions/README.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Decisions
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Document%20Processing/Readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Document Processing
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../IBM%20Cloud%20Pak%20for%20Business%20Automation%20%28End-to-End%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IBM Cloud Pak for Business Automation (End-to-End)
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Process%20Mining/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Process Mining
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Robotic%20Process%20Automation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Robotic Process Automation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../watsonx%20Orchestrate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Watsonx Orchestrate
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Workflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Workflow
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="exercise-4-deploy-postgresql">Exercise 4: Deploy PostgreSQL<a class="headerlink" href="#exercise-4-deploy-postgresql" title="Permanent link">&para;</a></h1>
<h1 id="41-introduction">4.1 Introduction<a class="headerlink" href="#41-introduction" title="Permanent link">&para;</a></h1>
<p>In this section, the PostgreSQL database will be deployed, and the database related property files of the CP4BA deployment updated with required configuration values. 
For the deployment of the PostgreSQL database, the Cloud Native PG Postgres operator will be used. The Cloud Native PG Postgres Operator is an open source initiative, 
its homepage can be found on https://cloudnative-pg.io/. The operator supports Openshift as well as plain Kubernetes, so called <em>CNCF</em> deployments. For commercial usage, 
with needed software support, there exist commercial products derived from the offering from Cloud Native PG.</p>
<h1 id="42-exercise-instructions">4.2 Exercise Instructions<a class="headerlink" href="#42-exercise-instructions" title="Permanent link">&para;</a></h1>
<ol>
<li>
<p>Switch to the <strong>Terminal</strong> window. Change to the cert-kubernetes/scripts directory.</p>
<div class="highlight"><pre><span></span><code>cd $HOME/cp4ba/cert-kubernetes/scripts
</code></pre></div>
</li>
<li>
<p>Review the database property files, to determine further information about required databases.</p>
<div class="highlight"><pre><span></span><code>gedit cp4ba-prerequisites/propertyfile/cp4ba_db_name_user.property
</code></pre></div>
</li>
<li>
<p>The file lists 4 databases, one for the GCD of the FileNet installation, two more for the two object stores, and one for Content Navigator. Close the gedit window again.</p>
</li>
<li>
<p>Switch to <strong>Firefox</strong> and select or open a tab with the <strong>Openshift Web Console</strong>. Login as <strong>ocpadmin</strong> with password passw0rd, if required. Note that the third-last character in the password is a zero. Then select in the menu <strong>OperatorHub</strong> from the <strong>Operator</strong> menu</p>
<p><img alt="Operator Hub Menu" src="../Images/5.2-OperatorHub.png" /></p>
</li>
<li>
<p>On the right side, enter <strong>postgres</strong> in the search prompt, and click on the <strong>CloudNativePG</strong> tile. The CloudNativePG operator can also be used with plain Kubernetes deployments, it does not depend on Openshift.</p>
<p><img alt="Cloud Native PG Operator" src="../Images/5.2-CloudNativePGOperator.png" /></p>
</li>
<li>
<p>If you want, read through the text which comes. Information from that page will not be included in any badge questions.  When ready, click on <strong>Install</strong></p>
<p><img alt="Install CloudNativePG" src="../Images/5.2-Install-CloudNativePG.png" /></p>
</li>
<li>
<p>Select to install the operator in a specific project / namespace, and select the <strong>ibm-cp4ba</strong> namespace for it. Then click on <strong>Install</strong>.</p>
<p><img alt="Review Installation Options" src="../Images/5.1-InstallOperator.png" /></p>
</li>
<li>
<p>Click on <strong>Installed Operators</strong> to review the deployment of the Operator. When it is ready, the operator should have Status <strong>Succeeded</strong>. </p>
<p><img alt="Installation Succeeded" src="../Images/5.1-InstallationSucceeded.png" /></p>
<p><strong>Note:</strong> The version number can differ from the one in the screenshot, as the CloudNativePG operator is upgraded regularly.</p>
</li>
<li>
<p>Select the <strong>Workflow -&gt; Pods</strong> menu. The operator pod is named cnpg-controller-manager. Check that the operator pod for the CloudNativePG is running.</p>
<p><img alt="cnpg-controller-manager is running" src="../Images/5.1-cnpg-running.png" /></p>
</li>
<li>
<p>Open a new tab in Firefox and navigate to the <a href="../LabData/postgres.yaml">LabData/postgres.yaml</a> file. Download the file <strong>postgres.yaml</strong> to the lab environment. To do that, with the content of the postgres.yaml file displayed in the Github window, right-click on the "Raw" link above and save the link to file.</p>
<p><img alt="Downloading postgres.yaml from Github" src="../Images/5.1-save-postgres-yaml.png" /></p>
</li>
<li>
<p>Change to the Terminal window. Change to the <strong>Downloads</strong> folder, then check and apply the <strong>postgres.yaml</strong> file</p>
<div class="highlight"><pre><span></span><code>cd
cd Downloads
gedit postgres.yaml
oc apply -f postgres.yaml
</code></pre></div>
<p>No changes are needed in the <strong>postgres.yaml</strong> file. Review, that the file mentions 4 tablespaces, and also creates two secret for the database user, and the database administrator. The database user will have the name <strong>cp4badbuser</strong>, and the database administrator will have the name <strong>postgres</strong>. Both have the same password, which is passw0rd, with the third-last character being a zero. Then close the editor again.</p>
</li>
<li>
<p>Deployment of PostgreSQL will first create an initialization pod, which sets up the persistent volume claim, then one new Postgres pod will be created. Monitor the output of the <code>oc get pods</code> command until the <strong>postgres-1</strong> pod is running</p>
<div class="highlight"><pre><span></span><code>oc get pods
</code></pre></div>
</li>
<li>
<p>The postgres.yaml file contains definitions which will deploy 4 tablespaces, one for each of the needed databases, into separate persistent volumes, which should give better performance over using only a single filesystem for all 4 databases. It assigns the tablespaces to the newly created database user <strong>cp4badbuser</strong>. The credentials for that user are provided to the secret <strong>cp4badbuser-secret</strong>, which is defined towards the bottom of the file. Lets verify if that succeeded properly. </p>
<p><img alt="installed tablespaces" src="../Images/5.1-installed-tablespaces.png" /></p>
<p>The required command is:
<div class="highlight"><pre><span></span><code>oc exec postgres-1 -- psql -U postgres -c &#39;\db+&#39;
</code></pre></div></p>
</li>
<li>
<p>Some of the postgres parameters need further customization, so copy out the parameters file for modification. The first command shows the full pathname of the postgresql.conf configuration file, which is needed for the subsequent commands.</p>
<div class="highlight"><pre><span></span><code>oc exec postgres-1 -- find /var/lib -name postgresql.conf
oc cp postgres-1:/var/lib/postgresql/data/pgdata/postgresql.conf postgresql.conf
</code></pre></div>
</li>
<li>
<p>Now edit the postgresql.conf configuration file.</p>
<div class="highlight"><pre><span></span><code>gedit postgresql.conf
</code></pre></div>
</li>
<li>
<p>The first place to change is the line showing <strong>max_connections</strong>. Change the value to at least <strong>500</strong>, which gives more than 50 connections per JDBC connector, as long as only one CPE pod is used.</p>
<p><img alt="editing postgresql-conf" src="../Images/5.2-postgresql-conf.png" /></p>
</li>
<li>
<p>The second place to change is the line showing <strong>max_prepared_transactions</strong>. Remove the # character in front of the the line, and change the value to support <strong>1000</strong> prepared transactions. Read more about both updates in the CP4BA Documentation: https://www.ibm.com/docs/en/cloud-paks/cp-biz-automation/23.0.2?topic=tpdcpe-using-postgresql-max-connections-max-prepared-transactions</p>
<p><img alt="editing max prepared transactions" src="../Images/5.2-postgresql-conf2.png" /></p>
</li>
<li>
<p>Save the file and close the editor.</p>
</li>
<li>
<p>Copy back the configuration file into the container. The directory containing it is backed up by a persistent volume, so any changes on it will persist. After copying the container, its required to restart Postgres, so delete the Pod for it to happen.</p>
<div class="highlight"><pre><span></span><code>oc cp postgresql.conf postgres-1:/var/lib/postgresql/data/pgdata/postgresql.conf
oc delete pod postgres-1
</code></pre></div>
</li>
<li>
<p>Next we need to confirm on the server name and port for connections to the database. As PostgreSQL is running in a pod, it can be reached through the service defined for it by the Postgres operator. There are three services, one of them allows modifications as well, it is named postgres-rw. It can be seen that the default port for PostgreSQL is 5432. </p>
<p><img alt="determining service address for postgresql deployment" src="../Images/5.2-get-services.png" /></p>
<p>The commands to determine this information are:</p>
<div class="highlight"><pre><span></span><code>oc get service
</code></pre></div>
</li>
<li>
<p>That service is made available through the DNS of Kubernetes, with the name <servicename>.<namespace/project>.svc. Lets check it by opening a shell in the operator pod, and test connectivity. </p>
<p><img alt="Checking Connectivity" src="../Images/5.2-checking-connectivity.png" /> </p>
<p>Of course the <strong>curl</strong> command cannot terminate, as PostgreSQL is not telnet, so abort it by pressing <strong>Ctrl-C</strong>. But the verbose output allows checking, if the connection can be made. Within Containers, connectivity cannot be checked with the usual ping command. The required commands are:</p>
<div class="highlight"><pre><span></span><code>oc get pod
oc exec &lt;name of ibm-cp4a-operator pod&gt; -it -- bash
curl -v telnet://postgres-rw.ibm-cp4ba.svc:5432
</code></pre></div>
<p>You can close the shell in the Operator pod again.</p>
</li>
<li>
<p>The last step is to update the property files, which have been generated previously, with the information from the Postgres database deployment. Navigate back to the directory containing them, and edit the files.</p>
<div class="highlight"><pre><span></span><code>cd $HOME/cp4ba/cert-kubernetes/scripts/cp4ba-prerequisites/propertyfile
gedit cp4ba_db_server.property
</code></pre></div>
</li>
<li>
<p>It is suggested to make the window wide enough to not be disturbed by the comments. Modify the server name, port, ssl, and client ssl settings in this file as indicated below.</p>
<p><img alt="Editing database property file" src="../Images/5.2-editing-db-property-file.png" /></p>
<blockquote>
<p>Hint: The name of the server had been used in one of the previous steps. You can copy it from there.</p>
</blockquote>
</li>
<li>
<p>Save the file, and close the editor. Then invoke the editor again on the other database related property file. Before invoking the editor, just determine how the database password passw0rd looks like, when its base64 encoded, that string is required when editing the next file.</p>
<div class="highlight"><pre><span></span><code>echo -n passw0rd | base64
gedit cp4ba_db_name_user.property
</code></pre></div>
<p><strong>Note:</strong> The <strong>-n</strong> option to echo will suppress the linefeed character, which echo normally prints following the output. If it is included, the linefeed will be part of the base64 encoded string, and might lead to illegal passwords, which are very hard to find later.</p>
</li>
<li>
<p>First step for editing the document is to replace all passwords. You can invoke the search and replace function through the hamburger menu on top right corner (next to the Save button). You can copy and paste both values from the editor, and from the Terminal window. The password needs to be replaced 4 times, for the four databases.</p>
<p><img alt="Editing DB User Property File - Passwords" src="../Images/5.2-db-user-properties.png" /></p>
</li>
<li>
<p>The next step is to replace the database user name. We will use one user account for all databases, so replace <strong><youruser1></strong> with <strong>cp4badbuser</strong> as indicated in the screenshot, 4 times. </p>
<p><img alt="Editing DB User Property File - Usernames" src="../Images/5.1-editing-user-properties2.png" /></p>
</li>
<li>
<p>Review the file, and check, if any further field need to be updated in the file, that should not be the case. So save the file, and quit the editor. </p>
</li>
</ol>
<h2 id="43-validation-steps">4.3 Validation steps<a class="headerlink" href="#43-validation-steps" title="Permanent link">&para;</a></h2>
<p>Successful installation of the DB Server was verified by the steps above already. Successful modification of the database server and users property files will be done through running of the <code>cp4ba-prerequisite.sh</code> script in Validate mode, in a later exercise. </p>
<p>A common error not detected (yet) by the prerequisite scripts in validate mode is to forget tuning the database configuration with increasing max connections and allowing prepared transactions. Therefore its recommended to double-check it at this point. Run the following command:</p>
<div class="highlight"><pre><span></span><code>oc exec postgres-1 -it -- psql -U postgres -c &quot;select name,setting from pg_settings where name IN (&#39;max_connections&#39;, &#39;max_prepared_transactions&#39;) ;&quot;
</code></pre></div>
<p>It should print following table:</p>
<p><img alt="Verifying Settings" src="../Images/5.3-verifying-settings.png" /></p>
<p>In the <a href="../Exercise-5-Configure-LDAP/">Next Exercise</a> the remaining configuration values,  as well as the LDAP-server related configuration values will be updated in the property files.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.sections"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.3220b9d7.min.js"></script>
      
    
  </body>
</html>